setwd("D:/scripts/bgcPlotter/Rscripts/bgcPlotter")
prefix <- "eagu"
admixPop <- "EAGU"
bgc.genes <-
combine_bgc_output(results.dir = "../../bgc_results_genes/",
prefix = prefix)
plot_lnl(df.list = bgc.genes,
prefix = prefix,
thin = 40,
plotDIR = "../../plots")
gene.outliers <-
get_bgc_outliers(
df.list = bgc.genes,
admix.pop = admixPop,
popmap = file.path("../../popmaps/", paste0(prefix, ".bgc.popmap_final.txt")),
loci.file = file.path("../../loci_files/", paste0(prefix, "_bgc_loci.txt"))
)
rm(bgc.genes)
gc()
bgc.full <-
combine_bgc_output(results.dir = "../../bgc_results_full/",
prefix = prefix)
plot_lnl(df.list = bgc.full,
prefix = paste0(prefix, "_full"),
thin = 40,
plotDIR = "../../plots")
full.outliers <-
get_bgc_outliers(
df.list = bgc.full,
admix.pop = admixPop,
popmap = file.path("../../popmaps/", paste0(prefix, ".bgc.popmap_final.txt")),
loci.file = file.path("../../bgc_results_full/",
paste0(prefix, "_bgc_loci.txt"))
)
rm(bgc.full)
gc()
phiPlot(outlier.list = gene.outliers,
popname = paste0(admixPop, " Genes"),
line.size = 0.25,
saveToFile = paste0(prefix, "_genes"),
plotDIR = "../../plots/",
both.outlier.tests = TRUE,
hist.y.origin = 1.2,
hist.height = 1.8,
margins = c(160.0, 5.5, 5.5, 5.5),
hist.binwidth = 0.05)
gc()
devtools::document()
devtools::document()
devtools::load_all()
devtools::document()
devtools::load_all()
prefix <- "eagu"
admixPop <- "EAGU"
bgc.genes <-
combine_bgc_output(results.dir = "../../bgc_results_genes/",
prefix = prefix, discard = 2500)
devtools::load_all()
bgc.genes <-
combine_bgc_output(results.dir = "../../bgc_results_genes/",
prefix = prefix, discard = 2500)
devtools::load_all()
bgc.genes <-
combine_bgc_output(results.dir = "../../bgc_results_genes/",
prefix = prefix, discard = 2500)
bgc.genes <-
combine_bgc_output(results.dir = "../../bgc_results_genes/",
prefix = prefix, discard = 2500)
devtools::load_all()
bgc.genes <-
combine_bgc_output(results.dir = "../../bgc_results_genes/",
prefix = prefix, discard = 2500)
bgc.genes <-
combine_bgc_output(results.dir = "../../bgc_results_genes/",
prefix = prefix, discard = 2500)
devtools::load_all()
bgc.genes <-
combine_bgc_output(results.dir = "../../bgc_results_genes/",
prefix = prefix, discard = 2500)
devtools::load_all()
bgc.genes <-
combine_bgc_output(results.dir = "../../bgc_results_genes/",
prefix = prefix, discard = 2500)
devtools::load_all()
devtools::document()
bgc.genes <-
combine_bgc_output(results.dir = "../../bgc_results_genes/",
prefix = prefix, discard = 2500)
bgc.genes <-
combine_bgc_output(results.dir = "../../bgc_results_genes/",
prefix = prefix, thin = 2)
bgc.genes <-
combine_bgc_output(results.dir = "../../bgc_results_genes/",
prefix = prefix,
discard = 2500)
plot_lnl(df.list = bgc.genes,
prefix = prefix,
thin = 40,
plotDIR = "../../plots")
gene.outliers <-
get_bgc_outliers(
df.list = bgc.genes,
admix.pop = admixPop,
popmap = file.path("../../popmaps/", paste0(prefix, ".bgc.popmap_final.txt")),
loci.file = file.path("../../loci_files/", paste0(prefix, "_bgc_loci.txt"))
)
rm(bgc.genes)
gc()
bgc.full <-
combine_bgc_output(results.dir = "../../bgc_results_full/",
prefix = prefix, discard = 2500)
plot_lnl(df.list = bgc.full,
prefix = paste0(prefix, "_full"),
thin = 40,
plotDIR = "../../plots")
full.outliers <-
get_bgc_outliers(
df.list = bgc.full,
admix.pop = admixPop,
popmap = file.path("../../popmaps/", paste0(prefix, ".bgc.popmap_final.txt")),
loci.file = file.path("../../bgc_results_full/",
paste0(prefix, "_bgc_loci.txt"))
)
rm(bgc.full)
gc()
phiPlot(outlier.list = gene.outliers,
popname = paste0(admixPop, " Genes"),
line.size = 0.25,
saveToFile = paste0(prefix, "_genes"),
plotDIR = "../../plots/",
both.outlier.tests = TRUE,
hist.y.origin = 1.2,
hist.height = 1.8,
margins = c(160.0, 5.5, 5.5, 5.5),
hist.binwidth = 0.05)
gc()
phiPlot(outlier.list = full.outliers,
popname = paste0(admixPop, " All"),
line.size = 0.25,
saveToFile = paste0(prefix, "_genome"),
plotDIR = "../../plots/",
both.outlier.tests = TRUE,
hist.y.origin = 1.2,
hist.height = 1.8,
margins = c(160.0, 5.5, 5.5, 5.5),
hist.binwidth = 0.05)
gc()
gff <- parseGFF(gff.filepath = "../../gff/genes.gff")
genes.annotated <-
join_bgc_gff(prefix = prefix,
outlier.list = gene.outliers,
gff.data = gff,
scafInfoDIR = "../../scaffold_info")
plot_outlier_ideogram(
prefix = prefix,
outliers.genes = genes.annotated,
outliers.full.scaffolds = full.outliers,
pafInfo = "../../pafscaff/refmap_asm20_scafTrans_pafscaff.scaffolds.tdt",
plotDIR = "../../plots",
missing.chrs = c("chr11", "chr21", "chr25"),
miss.chr.length = c(4997863, 1374423, 1060959)
)
devtools::document()
usethis::use_package("data.table")
usethis::package("dplyr")
usethis::use_package("dplyr")
usethis::use_package("bayestestR")
usethis::use_package("scales")
usethis::use_package("reshape2")
usethis::use_package("ggplot2")
usethis::use_package("forcats")
usethis::use_package("gtools")
usethis::use_package("RIdeogram")
usethis::use_package("gdata")
devtools::document()
prefix <- "population1"
admixPop <- "Pop 1"
bgc.genes <-
combine_bgc_output(results.dir = "../../bgc_results_genes/",
prefix = prefix,
discard = 2500)
devtools::load_all()
bgc.genes <-
combine_bgc_output(results.dir = "../../bgc_results_genes/",
prefix = prefix,
discard = 2500)
setwd("D:/scripts/bgcPlotter/Rscripts/bgcPlotter")
bgc.genes <-
combine_bgc_output(results.dir = "../../bgc_results_genes/",
prefix = prefix,
discard = 2500)
devtools::load_all()
setwd("D:/scripts/bgcPlotter/Rscripts/bgcPlotter")
prefix <- "population1"
admixPop <- "GUTT"
bgc.genes <-
combine_bgc_output(results.dir = "../../bgc_results_genes/",
prefix = prefix,
discard = 2500)
bgc.genes <-
combine_bgc_output(results.dir = "../example_data/",
prefix = prefix,
discard = 2500)
bgc.genes <-
combine_bgc_output(results.dir = "../example_data/",
prefix = prefix)
rm(bgc.genes)
bgc.genes <-
combine_bgc_output(results.dir = "../example_data/",
prefix = prefix)
rm(bgc.genes)
bgc.genes <-
combine_bgc_output(results.dir = "../example_data/",
prefix = prefix)
rm(bgc.genes)
bgc.genes <-
combine_bgc_output(results.dir = "../example_data/",
prefix = prefix)
object.size(bgc.genes)
gene.outliers <-
get_bgc_outliers(
df.list = bgc.genes,
admix.pop = admixPop,
popmap = file.path("../../popmaps/", paste0(prefix,
".bgc.popmap_final.txt")),
loci.file = file.path("../example_data/", paste0(prefix,
"_bgc_loci.txt"))
)
gene.outliers <-
get_bgc_outliers(
df.list = bgc.genes,
admix.pop = admixPop,
popmap = file.path("../../popmaps", paste0(prefix,
".bgc.popmap_final.txt")),
loci.file = file.path("../example_data/", paste0(prefix,
"_bgc_loci.txt"))
)
setwd("D:/scripts/bgcPlotter/Rscripts/bgcPlotter")
gene.outliers <-
get_bgc_outliers(
df.list = bgc.genes,
admix.pop = admixPop,
popmap = file.path("../../popmaps", paste0(prefix,
".bgc.popmap_final.txt"))
loci.file = file.path("../example_data/", paste0(prefix,
"_bgc_loci.txt"))
gene.outliers <-
get_bgc_outliers(
df.list = bgc.genes,
admix.pop = admixPop,
popmap = file.path("../../popmaps", paste0(prefix,
".bgc.popmap_final.txt")),
loci.file = file.path("../example_data/", paste0(prefix,
"_bgc_loci.txt"))
)
gene.outliers <-
get_bgc_outliers(
df.list = bgc.genes,
admix.pop = admixPop,
popmap = file.path("../example_data/", paste0(prefix,
".bgc.popmap_final.txt")),
loci.file = file.path("../example_data/", paste0(prefix,
"_bgc_loci.txt"))
)
gene.outliers <-
get_bgc_outliers(
df.list = bgc.genes,
admix.pop = admixPop,
popmap = file.path("../example_data", paste0(prefix,
".bgc.popmap_final.txt")),
loci.file = file.path("../example_data/", paste0(prefix,
"_bgc_loci.txt"))
)
gene.outliers <-
get_bgc_outliers(
df.list = bgc.genes,
admix.pop = admixPop,
popmap = file.path("../example_data/", paste0(prefix,
".bgc.popmap.txt")),
loci.file = file.path("../example_data/", paste0(prefix,
"_bgc_loci.txt"))
)
View(bgc.genes)
gene.outliers <-
get_bgc_outliers(
df.list = bgc.genes,
admix.pop = admixPop,
popmap = file.path("../example_data/", paste0(prefix,
".bgc.popmap.txt")),
loci.file = file.path("../example_data/", paste0(prefix,
"_bgc_loci.txt"))
)
devtools::load_all()
gene.outliers <-
get_bgc_outliers(
df.list = bgc.genes,
admix.pop = admixPop,
popmap = file.path("../example_data/", paste0(prefix,
".bgc.popmap.txt")),
loci.file = file.path("../example_data/", paste0(prefix,
"_bgc_loci.txt"))
)
devtools::load_all()
gene.outliers <-
get_bgc_outliers(
df.list = bgc.genes,
admix.pop = admixPop,
popmap = file.path("../example_data/", paste0(prefix,
".bgc.popmap.txt")),
loci.file = file.path("../example_data/", paste0(prefix,
"_bgc_loci.txt"))
)
devtools::load_all()
gene.outliers <-
get_bgc_outliers(
df.list = bgc.genes,
admix.pop = admixPop,
popmap = file.path("../example_data/", paste0(prefix,
".bgc.popmap.txt")),
loci.file = file.path("../example_data/", paste0(prefix,
"_bgc_loci.txt"))
)
gene.outliers <-
get_bgc_outliers(
df.list = bgc.genes,
admix.pop = admixPop,
popmap = file.path("../example_data/", paste0(prefix,
".bgc.popmap.txt")),
loci.file = file.path("../example_data/", paste0(prefix,
"_bgc_loci.txt"))
)
full.outliers <-
get_bgc_outliers(
df.list = bgc.full,
admix.pop = admixPop,
popmap = file.path("../../popmaps/", paste0(prefix, ".bgc.popmap_final.txt")),
loci.file = file.path("../../bgc_results_full/",
paste0(prefix, "_full_bgc_loci.txt"))
)
bgc.full <-
combine_bgc_output(results.dir = "../../bgc_results_full/",
prefix = paste0(prefix, "_full"))
bgc.full <-
combine_bgc_output(results.dir = "../example_data/",
prefix = paste0(prefix, "_full"))
usethis::use_data(bgc.genes)
usethis::use_data(bgc.full)
devtools::document()
full.outliers <-
get_bgc_outliers(
df.list = bgc.full,
admix.pop = admixPop,
popmap = file.path("../example_data/", paste0(prefix,
".bgc.popmap.txt")),
loci.file = file.path("../example_data/",
paste0(prefix, "_full_bgc_loci.txt"))
)
full.outliers <-
get_bgc_outliers(
df.list = bgc.full,
admix.pop = admixPop,
popmap = file.path("../example_data/", paste0(prefix,
".bgc.popmap.txt")),
loci.file = file.path("../example_data/",
paste0(prefix, "_full_bgc_loci.txt"))
)
phiPlot(outlier.list = gene.outliers,
popname = paste0(admixPop, " Genes"),
line.size = 0.25,
saveToFile = paste0(prefix, "_genes"),
plotDIR = "../../plots/",
both.outlier.tests = TRUE,
hist.y.origin = 1.2,
hist.height = 1.8,
margins = c(160.0, 5.5, 5.5, 5.5),
hist.binwidth = 0.05)
phiPlot(outlier.list = full.outliers,
popname = paste0(admixPop, " All"),
line.size = 0.25,
saveToFile = paste0(prefix, "_genome"),
plotDIR = "../../plots/",
both.outlier.tests = TRUE,
hist.y.origin = 1.2,
hist.height = 1.8,
margins = c(160.0, 5.5, 5.5, 5.5),
hist.binwidth = 0.05)
devtools::install_github("btmartin721/bgcPlotter")
library("bgcPlotter")
library("bgcPlotter")
data("bgc.genes")
force(bgc.genes)
data(bgc.full)
force(bgc.full)
prefix <- "gutt"
admixPop <- "GUTT"
setwd("D:/scripts/bgcPlotter")
prefix <- "gutt"
admixPop <- "GUTT"
bgc.genes <-
combine_bgc_output(results.dir = "./bgc_results_genes/",
prefix = prefix)
plot_lnl(df.list = bgc.genes,
prefix = prefix,
thin = 40,
plotDIR = "../../plots")
gene.outliers <-
get_bgc_outliers(
df.list = bgc.genes,
admix.pop = admixPop,
popmap = file.path("../example_data/", paste0(prefix,
".bgc.popmap.txt")),
loci.file = file.path("../example_data/", paste0(prefix,
"_bgc_loci.txt"))
)
plot_lnl(df.list = bgc.genes,
prefix = prefix,
thin = 40,
plotDIR = "./plots")
gene.outliers <-
get_bgc_outliers(
df.list = bgc.genes,
admix.pop = admixPop,
popmap = file.path("./popmaps/", paste0(prefix, ".bgc.popmap_final.txt")),
loci.file = file.path("./bgc_results_genes/",
paste0(prefix, "_bgc_loci.txt"))
)
gene.outliers <-
get_bgc_outliers(
df.list = bgc.genes,
admix.pop = admixPop,
popmap = file.path("./popmaps/", paste0(prefix, ".bgc.popmap_final.txt")),
loci.file = file.path("./bgc_results_genes/",
paste0(prefix, "_bgc_loci.txt"))
)
bgc.genes <-
combine_bgc_output(results.dir = "./bgc_results_genes/",
prefix = prefix, discard = 3000)
plot_lnl(df.list = bgc.genes,
prefix = prefix,
thin = 40,
plotDIR = "./plots")
gene.outliers <-
get_bgc_outliers(
df.list = bgc.genes,
admix.pop = admixPop,
popmap = file.path("./popmaps/", paste0(prefix, ".bgc.popmap_final.txt")),
loci.file = file.path("./bgc_results_genes/",
paste0(prefix, "_bgc_loci.txt"))
)
phiPlot(outlier.list = gene.outliers,
popname = paste0(admixPop, " Genes"),
line.size = 0.25,
saveToFile = paste0(prefix, "_genes"),
plotDIR = "../../plots/",
both.outlier.tests = TRUE,
hist.y.origin = 1.2,
hist.height = 1.8,
margins = c(160.0, 5.5, 5.5, 5.5),
hist.binwidth = 0.05)
phiPlot(outlier.list = gene.outliers,
popname = paste0(admixPop, " Genes"),
line.size = 0.25,
saveToFile = paste0(prefix, "_genes"),
plotDIR = "../../plots/",
hist.y.origin = 1.2,
hist.height = 1.8,
margins = c(160.0, 5.5, 5.5, 5.5),
hist.binwidth = 0.05)
phiPlot(outlier.list = gene.outliers,
popname = paste0(admixPop, " Genes"),
line.size = 0.25,
saveToFile = paste0(prefix, "_genes"),
plotDIR = "./plots/",
hist.y.origin = 1.2,
hist.height = 1.8,
margins = c(160.0, 5.5, 5.5, 5.5),
hist.binwidth = 0.05)
remove.packages("bgcPlotter")
devtools::install_github("btmartin721/bgcPlotter")
devtools::install_github("btmartin721/bgcPlotter", auth_token = 33babc440af4a1ef62367edff1fef348aa07ac0d)
devtools::install_github("btmartin721/bgcPlotter", auth_token = "33babc440af4a1ef62367edff1fef348aa07ac0d")
library("bgcPlotter")
knitr::opts_chunk$set(echo = TRUE)
library("bgcPlotter")
phiPlot(outlier.list = gene.outliers,
popname = paste0(admixPop, " Genes"),
line.size = 0.25,
saveToFile = paste0(prefix, "_genes"),
plotDIR = "./plots/",
hist.y.origin = 1.2,
hist.height = 1.8,
margins = c(160.0, 5.5, 5.5, 5.5),
hist.binwidth = 0.05,
both.outlier.tests = TRUE)
devtools::build_vignettes()
devtools::load_all()
devtools::document()
devtools::build_vignettes()
setwd("D:/scripts/bgcPlotter/Rscripts/bgcPlotter")
devtools::document()
devtools::load_all()
devtools::build_vignettes()
devtools::build_vignettes()
devtools::load_all()
devtools::document()
devtools::build_vignettes()
.Last.error.trace
knitr::opts_chunk$set(echo = TRUE)
prefix <- "population1"
bgc.genes <-
combine_bgc_output(results.dir = "exampledata/",
prefix = prefix)
