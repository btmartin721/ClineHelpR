combine_bgc_output(results.dir = "../../bgc_results_genes/",
prefix = prefix)
bgc.full <-
combine_bgc_output(results.dir = "../../bgc_results_full/",
prefix = prefix)
plot_lnl(df.list = bgc.genes,
prefix = prefix,
thin = 40,
plotDIR = "../../plots")
plot_lnl(df.list = bgc.full,
prefix = paste0(prefix, "_full"),
thin = 40,
plotDIR = "../../plots")
gene.outliers <-
get_bgc_outliers(
df.list = bgc.genes,
admix.pop = admixPop,
popmap = file.path("../../popmaps/", paste0(prefix, ".bgc.popmap_final.txt")),
loci.file = file.path("../../loci_files/", paste0(prefix, "_bgc_loci.txt"))
)
full.outliers <-
get_bgc_outliers(
df.list = bgc.full,
admix.pop = admixPop,
popmap = file.path("../../popmaps/", paste0(prefix, ".bgc.popmap_final.txt")),
loci.file = file.path("../../bgc_results_full/",
paste0(prefix, "_bgc_loci.txt"))
)
phiPlot(outlier.list = gene.outliers,
popname = paste0(admixPop, " Genes"),
line.size = 0.25,
saveToFile = paste0(prefix, "_genes"),
plotDIR = "../../plots/")
phiPlot(outlier.list = gene.outliers,
popname = paste0(admixPop, " Genes"),
line.size = 0.25,
saveToFile = paste0(prefix, "_genes"),
plotDIR = "../../plots/",
both.outlier.tests = TRUE)
phiPlot(outlier.list = gene.outliers,
popname = paste0(admixPop, " Genes"),
line.size = 0.25,
saveToFile = paste0(prefix, "_genes"),
plotDIR = "../../plots/",
both.outlier.tests = TRUE, hist.y.origin = 1.2, hist.height = 1.8)
phiPlot(outlier.list = gene.outliers,
popname = paste0(admixPop, " Genes"),
line.size = 0.25,
saveToFile = paste0(prefix, "_genes"),
plotDIR = "../../plots/",
both.outlier.tests = TRUE,
hist.y.origin = 1.2,
hist.height = 1.8,
margins = c(200.0, 5.5, 5.5, 5.5))
devtools::load_all()
phiPlot(outlier.list = gene.outliers,
popname = paste0(admixPop, " Genes"),
line.size = 0.25,
saveToFile = paste0(prefix, "_genes"),
plotDIR = "../../plots/",
both.outlier.tests = TRUE,
hist.y.origin = 1.2,
hist.height = 1.8,
margins = c(160.0, 5.5, 5.5, 5.5))
devtools::load_all()
phiPlot(outlier.list = gene.outliers,
popname = paste0(admixPop, " Genes"),
line.size = 0.25,
saveToFile = paste0(prefix, "_genes"),
plotDIR = "../../plots/",
both.outlier.tests = TRUE,
hist.y.origin = 1.2,
hist.height = 1.8,
margins = c(160.0, 5.5, 5.5, 5.5))
devtools::load_all()
phiPlot(outlier.list = gene.outliers,
popname = paste0(admixPop, " Genes"),
line.size = 0.25,
saveToFile = paste0(prefix, "_genes"),
plotDIR = "../../plots/",
both.outlier.tests = TRUE,
hist.y.origin = 1.2,
hist.height = 1.8,
margins = c(160.0, 5.5, 5.5, 5.5))
phiPlot(outlier.list = gene.outliers,
popname = paste0(admixPop, " Genes"),
line.size = 0.25,
saveToFile = paste0(prefix, "_genes"),
plotDIR = "../../plots/",
both.outlier.tests = TRUE,
hist.y.origin = 1.2,
hist.height = 1.8,
margins = c(160.0, 5.5, 5.5, 5.5), hist.binwidth = 0.05)
devtools::load_all()
full.outliers <-
get_bgc_outliers(
df.list = bgc.full,
phiPlot(outlier.list = gene.outliers,
popname = paste0(admixPop, " Genes"),
line.size = 0.25,
saveToFile = paste0(prefix, "_genes"),
plotDIR = "../../plots/",
both.outlier.tests = TRUE,
hist.y.origin = 1.2,
hist.height = 1.8,
margins = c(160.0, 5.5, 5.5, 5.5), hist.binwidth = 0.05)    admix.pop = admixPop,
popmap = file.path("../../popmaps/", paste0(prefix, ".bgc.popmap_final.txt")),
loci.file = file.path("../../bgc_results_full/",
paste0(prefix, "_bgc_loci.txt"))
)
phiPlot(outlier.list = gene.outliers,
popname = paste0(admixPop, " Genes"),
line.size = 0.25,
saveToFile = paste0(prefix, "_genes"),
plotDIR = "../../plots/",
both.outlier.tests = TRUE,
hist.y.origin = 1.2,
hist.height = 1.8,
margins = c(160.0, 5.5, 5.5, 5.5), hist.binwidth = 0.05)
max(gene.outliers[[3]]$hi)
phiPlot(outlier.list = gene.outliers,
popname = paste0(admixPop, " Genes"),
line.size = 0.25,
saveToFile = paste0(prefix, "_genes"),
plotDIR = "../../plots/",
both.outlier.tests = TRUE,
hist.y.origin = 1.2,
hist.height = 1.8,
margins = c(160.0, 5.5, 5.5, 5.5),
hist.binwidth = 0.05)
devtools::load_all()
phiPlot(outlier.list = gene.outliers,
popname = paste0(admixPop, " Genes"),
line.size = 0.25,
saveToFile = paste0(prefix, "_genes"),
plotDIR = "../../plots/",
both.outlier.tests = TRUE,
hist.y.origin = 1.2,
hist.height = 1.8,
margins = c(160.0, 5.5, 5.5, 5.5),
hist.binwidth = 0.05)
devtools::load_all()
phiPlot(outlier.list = gene.outliers,
popname = paste0(admixPop, " Genes"),
line.size = 0.25,
saveToFile = paste0(prefix, "_genes"),
plotDIR = "../../plots/",
both.outlier.tests = TRUE,
hist.y.origin = 1.2,
hist.height = 1.8,
margins = c(160.0, 5.5, 5.5, 5.5),
hist.binwidth = 0.05)
devtools::load_all()
phiPlot(outlier.list = gene.outliers,
popname = paste0(admixPop, " Genes"),
line.size = 0.25,
saveToFile = paste0(prefix, "_genes"),
plotDIR = "../../plots/",
both.outlier.tests = TRUE,
hist.y.origin = 1.2,
hist.height = 1.8,
margins = c(160.0, 5.5, 5.5, 5.5),
hist.binwidth = 0.05)
devtools::load_all()
phiPlot(outlier.list = gene.outliers,
popname = paste0(admixPop, " Genes"),
line.size = 0.25,
saveToFile = paste0(prefix, "_genes"),
plotDIR = "../../plots/",
both.outlier.tests = TRUE,
hist.y.origin = 1.2,
hist.height = 1.8,
margins = c(160.0, 5.5, 5.5, 5.5),
hist.binwidth = 0.05)
devtools::load_all()
phiPlot(outlier.list = gene.outliers,
popname = paste0(admixPop, " Genes"),
line.size = 0.25,
saveToFile = paste0(prefix, "_genes"),
plotDIR = "../../plots/",
both.outlier.tests = TRUE,
hist.y.origin = 1.2,
hist.height = 1.8,
margins = c(160.0, 5.5, 5.5, 5.5),
hist.binwidth = 0.05)
devtools::load_all()
phiPlot(outlier.list = gene.outliers,
popname = paste0(admixPop, " Genes"),
line.size = 0.25,
saveToFile = paste0(prefix, "_genes"),
plotDIR = "../../plots/",
both.outlier.tests = TRUE,
hist.y.origin = 1.2,
hist.height = 1.8,
margins = c(160.0, 5.5, 5.5, 5.5),
hist.binwidth = 0.05)
devtools::load_all()
prefix <- "eagu"
admixPop <- "EAGU"
bgc.genes <-
combine_bgc_output(results.dir = "../../bgc_results_genes/",
prefix = prefix)
bgc.full <-
combine_bgc_output(results.dir = "../../bgc_results_full/",
prefix = prefix)
plot_lnl(df.list = bgc.genes,
prefix = prefix,
thin = 40,
plotDIR = "../../plots")
plot_lnl(df.list = bgc.full,
prefix = paste0(prefix, "_full"),
thin = 40,
plotDIR = "../../plots")
gene.outliers <-
get_bgc_outliers(
df.list = bgc.genes,
admix.pop = admixPop,
popmap = file.path("../../popmaps/", paste0(prefix, ".bgc.popmap_final.txt")),
loci.file = file.path("../../loci_files/", paste0(prefix, "_bgc_loci.txt"))
)
full.outliers <-
get_bgc_outliers(
df.list = bgc.full,
admix.pop = admixPop,
popmap = file.path("../../popmaps/", paste0(prefix, ".bgc.popmap_final.txt")),
loci.file = file.path("../../bgc_results_full/",
paste0(prefix, "_bgc_loci.txt"))
)
phiPlot(outlier.list = gene.outliers,
popname = paste0(admixPop, " Genes"),
line.size = 0.25,
saveToFile = paste0(prefix, "_genes"),
plotDIR = "../../plots/",
both.outlier.tests = TRUE,
hist.y.origin = 1.2,
hist.height = 1.8,
margins = c(160.0, 5.5, 5.5, 5.5),
hist.binwidth = 0.05)
setwd("D:/scripts/bgcPlotter/Rscripts/bgcPlotter")
bgc.genes <-
combine_bgc_output(results.dir = "../../bgc_results_genes/",
prefix = prefix)
bgc.full <-
combine_bgc_output(results.dir = "../../bgc_results_full/",
prefix = prefix)
plot_lnl(df.list = bgc.genes,
prefix = prefix,
thin = 40,
plotDIR = "../../plots")
plot_lnl(df.list = bgc.full,
prefix = paste0(prefix, "_full"),
thin = 40,
plotDIR = "../../plots")
gene.outliers <-
get_bgc_outliers(
df.list = bgc.genes,
admix.pop = admixPop,
popmap = file.path("../../popmaps/", paste0(prefix, ".bgc.popmap_final.txt")),
loci.file = file.path("../../loci_files/", paste0(prefix, "_bgc_loci.txt"))
)
full.outliers <-
get_bgc_outliers(
df.list = bgc.full,
admix.pop = admixPop,
popmap = file.path("../../popmaps/", paste0(prefix, ".bgc.popmap_final.txt")),
loci.file = file.path("../../bgc_results_full/",
paste0(prefix, "_bgc_loci.txt"))
)
phiPlot(outlier.list = gene.outliers,
popname = paste0(admixPop, " Genes"),
line.size = 0.25,
saveToFile = paste0(prefix, "_genes"),
plotDIR = "../../plots/",
both.outlier.tests = TRUE,
hist.y.origin = 1.2,
hist.height = 1.8,
margins = c(160.0, 5.5, 5.5, 5.5),
hist.binwidth = 0.05)
devtools::load_all()
bgc.genes <-
combine_bgc_output(results.dir = "../../bgc_results_genes/",
prefix = prefix)
bgc.full <-
combine_bgc_output(results.dir = "../../bgc_results_full/",
prefix = prefix)
plot_lnl(df.list = bgc.genes,
prefix = prefix,
thin = 40,
plotDIR = "../../plots")
plot_lnl(df.list = bgc.full,
prefix = paste0(prefix, "_full"),
thin = 40,
plotDIR = "../../plots")
gene.outliers <-
get_bgc_outliers(
df.list = bgc.genes,
admix.pop = admixPop,
popmap = file.path("../../popmaps/", paste0(prefix, ".bgc.popmap_final.txt")),
loci.file = file.path("../../loci_files/", paste0(prefix, "_bgc_loci.txt"))
)
full.outliers <-
get_bgc_outliers(
df.list = bgc.full,
admix.pop = admixPop,
popmap = file.path("../../popmaps/", paste0(prefix, ".bgc.popmap_final.txt")),
loci.file = file.path("../../bgc_results_full/",
paste0(prefix, "_bgc_loci.txt"))
)
phiPlot(outlier.list = gene.outliers,
popname = paste0(admixPop, " Genes"),
line.size = 0.25,
saveToFile = paste0(prefix, "_genes"),
plotDIR = "../../plots/",
both.outlier.tests = TRUE,
hist.y.origin = 1.2,
hist.height = 1.8,
margins = c(160.0, 5.5, 5.5, 5.5),
hist.binwidth = 0.05)
View(bgc.full)
gc()
devtools::load_all()
setwd("D:/scripts/bgcPlotter/Rscripts/bgcPlotter")
prefix <- "eagu"
admixPop <- "EAGU"
bgc.genes <-
combine_bgc_output(results.dir = "../../bgc_results_genes/",
prefix = prefix)
plot_lnl(df.list = bgc.genes,
prefix = prefix,
thin = 40,
plotDIR = "../../plots")
gene.outliers <-
get_bgc_outliers(
df.list = bgc.genes,
admix.pop = admixPop,
popmap = file.path("../../popmaps/", paste0(prefix, ".bgc.popmap_final.txt")),
loci.file = file.path("../../loci_files/", paste0(prefix, "_bgc_loci.txt"))
)
rm(bgc.genes)
gc()
bgc.full <-
combine_bgc_output(results.dir = "../../bgc_results_full/",
prefix = prefix)
plot_lnl(df.list = bgc.full,
prefix = paste0(prefix, "_full"),
thin = 40,
plotDIR = "../../plots")
full.outliers <-
get_bgc_outliers(
df.list = bgc.full,
admix.pop = admixPop,
popmap = file.path("../../popmaps/", paste0(prefix, ".bgc.popmap_final.txt")),
loci.file = file.path("../../bgc_results_full/",
paste0(prefix, "_bgc_loci.txt"))
)
rm(bgc.full)
gc()
phiPlot(outlier.list = gene.outliers,
popname = paste0(admixPop, " Genes"),
line.size = 0.25,
saveToFile = paste0(prefix, "_genes"),
plotDIR = "../../plots/",
both.outlier.tests = TRUE,
hist.y.origin = 1.2,
hist.height = 1.8,
margins = c(160.0, 5.5, 5.5, 5.5),
hist.binwidth = 0.05)
gc()
devtools::document()
devtools::document()
devtools::load_all()
devtools::document()
devtools::load_all()
prefix <- "eagu"
admixPop <- "EAGU"
bgc.genes <-
combine_bgc_output(results.dir = "../../bgc_results_genes/",
prefix = prefix, discard = 2500)
devtools::load_all()
bgc.genes <-
combine_bgc_output(results.dir = "../../bgc_results_genes/",
prefix = prefix, discard = 2500)
devtools::load_all()
bgc.genes <-
combine_bgc_output(results.dir = "../../bgc_results_genes/",
prefix = prefix, discard = 2500)
bgc.genes <-
combine_bgc_output(results.dir = "../../bgc_results_genes/",
prefix = prefix, discard = 2500)
devtools::load_all()
bgc.genes <-
combine_bgc_output(results.dir = "../../bgc_results_genes/",
prefix = prefix, discard = 2500)
bgc.genes <-
combine_bgc_output(results.dir = "../../bgc_results_genes/",
prefix = prefix, discard = 2500)
devtools::load_all()
bgc.genes <-
combine_bgc_output(results.dir = "../../bgc_results_genes/",
prefix = prefix, discard = 2500)
devtools::load_all()
bgc.genes <-
combine_bgc_output(results.dir = "../../bgc_results_genes/",
prefix = prefix, discard = 2500)
devtools::load_all()
devtools::document()
bgc.genes <-
combine_bgc_output(results.dir = "../../bgc_results_genes/",
prefix = prefix, discard = 2500)
bgc.genes <-
combine_bgc_output(results.dir = "../../bgc_results_genes/",
prefix = prefix, thin = 2)
bgc.genes <-
combine_bgc_output(results.dir = "../../bgc_results_genes/",
prefix = prefix,
discard = 2500)
plot_lnl(df.list = bgc.genes,
prefix = prefix,
thin = 40,
plotDIR = "../../plots")
gene.outliers <-
get_bgc_outliers(
df.list = bgc.genes,
admix.pop = admixPop,
popmap = file.path("../../popmaps/", paste0(prefix, ".bgc.popmap_final.txt")),
loci.file = file.path("../../loci_files/", paste0(prefix, "_bgc_loci.txt"))
)
rm(bgc.genes)
gc()
bgc.full <-
combine_bgc_output(results.dir = "../../bgc_results_full/",
prefix = prefix, discard = 2500)
plot_lnl(df.list = bgc.full,
prefix = paste0(prefix, "_full"),
thin = 40,
plotDIR = "../../plots")
full.outliers <-
get_bgc_outliers(
df.list = bgc.full,
admix.pop = admixPop,
popmap = file.path("../../popmaps/", paste0(prefix, ".bgc.popmap_final.txt")),
loci.file = file.path("../../bgc_results_full/",
paste0(prefix, "_bgc_loci.txt"))
)
rm(bgc.full)
gc()
phiPlot(outlier.list = gene.outliers,
popname = paste0(admixPop, " Genes"),
line.size = 0.25,
saveToFile = paste0(prefix, "_genes"),
plotDIR = "../../plots/",
both.outlier.tests = TRUE,
hist.y.origin = 1.2,
hist.height = 1.8,
margins = c(160.0, 5.5, 5.5, 5.5),
hist.binwidth = 0.05)
gc()
phiPlot(outlier.list = full.outliers,
popname = paste0(admixPop, " All"),
line.size = 0.25,
saveToFile = paste0(prefix, "_genome"),
plotDIR = "../../plots/",
both.outlier.tests = TRUE,
hist.y.origin = 1.2,
hist.height = 1.8,
margins = c(160.0, 5.5, 5.5, 5.5),
hist.binwidth = 0.05)
gc()
gff <- parseGFF(gff.filepath = "../../gff/genes.gff")
genes.annotated <-
join_bgc_gff(prefix = prefix,
outlier.list = gene.outliers,
gff.data = gff,
scafInfoDIR = "../../scaffold_info")
plot_outlier_ideogram(
prefix = prefix,
outliers.genes = genes.annotated,
outliers.full.scaffolds = full.outliers,
pafInfo = "../../pafscaff/refmap_asm20_scafTrans_pafscaff.scaffolds.tdt",
plotDIR = "../../plots",
missing.chrs = c("chr11", "chr21", "chr25"),
miss.chr.length = c(4997863, 1374423, 1060959)
)
devtools::document()
usethis::use_package("data.table")
usethis::package("dplyr")
usethis::use_package("dplyr")
usethis::use_package("bayestestR")
usethis::use_package("scales")
usethis::use_package("reshape2")
usethis::use_package("ggplot2")
usethis::use_package("forcats")
usethis::use_package("gtools")
usethis::use_package("RIdeogram")
usethis::use_package("gdata")
devtools::document()
prefix <- "population1"
admixPop <- "Pop 1"
bgc.genes <-
combine_bgc_output(results.dir = "../../bgc_results_genes/",
prefix = prefix,
discard = 2500)
devtools::load_all()
bgc.genes <-
combine_bgc_output(results.dir = "../../bgc_results_genes/",
prefix = prefix,
discard = 2500)
setwd("D:/scripts/bgcPlotter/Rscripts/bgcPlotter")
bgc.genes <-
combine_bgc_output(results.dir = "../../bgc_results_genes/",
prefix = prefix,
discard = 2500)
